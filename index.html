<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>تطبيق المكتب</title>
  <meta name="description" content="العشرات من القوانين افي مختلف المجالات القانونية للمحامى المصرى">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  
  <!-- Custom Styles -->
  <style>
    body {
      background: linear-gradient(180deg, #f8fafc, #ffffff);
      font-family: 'Cairo', sans-serif;
    }
    
    .screenshot {
      object-fit: cover;
      width: 150px;
      height: 300px;
      max-width: 150px;
      max-height: 300px;
    }
    
    /* Hide scrollbar */
    .scrollbar-hide::-webkit-scrollbar {
      display: none;
    }
    
    .scrollbar-hide {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    
    /* Arrow button styles */
    .arrow-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background-color: rgba(55, 65, 81, 0.7);
      color: white;
      font-size: 3rem;
      font-weight: bold;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      transition: background-color 0.3s ease;
    }
    
    .arrow-btn:hover {
      background-color: rgba(55, 65, 81, 0.9);
    }
    
    /* Description styles */
    .description-text {
      overflow: hidden;
      transition: max-height 0.3s ease;
      line-height: 1.6;
    }
    
    .description-text.collapsed {
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      max-height: 4.8em; /* 3 lines × 1.6 line-height */
    }
    
    .description-text.expanded {
      max-height: 1000px;
    }
    
    .toggle-btn {
      color: #1a73e8;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      margin-top: 4px;
      display: inline-block;
    }
    
    .toggle-btn:hover {
      text-decoration: underline;
    }
  </style>
</head>

<body class="antialiased text-gray-800">

  <!-- Header -->
  <header class="max-w-md mx-auto p-4">
    <div class="flex items-center gap-3">
      <img src="icon.png" alt="App Icon" class="w-16 h-16 rounded-2xl shadow">
      <h1 class="text-2xl font-bold">المكتب</h1>
    </div>
  </header>

  <!-- Main Content -->
  <main class="max-w-md mx-auto px-4">
    
    <!-- Description & Download Section -->
    <section class="py-4">
      <div class="flex flex-col items-center text-center space-y-4">
        <div class="w-full">
          <p id="description" class="description-text collapsed text-gray-500 text-base text-right">
العشرات من القوانين افي مختلف المجالات القانونية للمحامى المصرى - 
كنظام الحكم و القوانين المدنية والإيجار و الشهر العقاري و القوانين الجنائية والأحوال الشخصية و القوانين التجارية و قوانين العمل و قوانين التأمينات و الضرائب و القضاء و التعليم و الطب و الزراعة و وقوانين متنوعة.
          </p>
          <span id="toggleBtn" class="toggle-btn text-right block" onclick="toggleDescription()">عرض المزيد</span>
        </div>
        
        <a href="https://github.com/HatemAppStore/almaktab/releases/download/auto/apk.apk" 
           download 
           class="block w-full text-white font-bold text-base px-6 py-3 rounded-xl shadow-lg transition transform active:scale-95"
           style="background-color: #000000;">
          تحميل التطبيق
        </a>
      </div>
    </section>

    <!-- Screenshots Section -->
    <section class="py-4">
      <div id="screenshots-container" class="flex gap-3 overflow-x-scroll scrollbar-hide pb-4" style="scroll-snap-type: x mandatory;">
        <!-- Screenshots will be loaded dynamically here -->
      </div>
    </section>

    <!-- Lightbox Modal -->
    <div id="lightbox" 
         class="fixed inset-0 bg-black bg-opacity-90 hidden" 
         style="z-index: 9999; display: none;" 
         onclick="closeLightbox()">
      
      <!-- Close Button -->
      <span class="absolute top-4 right-6 text-white text-3xl font-bold cursor-pointer" 
            style="z-index: 10000;"
            onclick="closeLightbox()">
        &times;
      </span>
      
      <!-- Previous Button -->
      <button class="arrow-btn" 
              style="right: 16px;" 
              onclick="event.stopPropagation(); navigateImage(-1)"
              aria-label="الصورة السابقة">
        ‹
      </button>
      
      <!-- Image -->
      <img id="lightbox-img" 
           src="" 
           onclick="event.stopPropagation()"
           style="position: absolute; top: 0; left: 0; width: 100vw; height: 100vh; object-fit: contain; padding: 0; margin: 0;"
           alt="لقطة شاشة مكبرة">
      
      <!-- Next Button -->
      <button class="arrow-btn" 
              style="left: 16px;" 
              onclick="event.stopPropagation(); navigateImage(1)"
              aria-label="الصورة التالية">
        ›
      </button>
    </div>

  </main>

  <!-- JavaScript -->
  <script>
    // Dynamically detect available screenshots (1-10)
    const screenshots = [];
    let currentImageIndex = 0;
    let loadedCount = 0;
    const totalToCheck = 10;

    /**
     * Toggle description expand/collapse
     */
    function toggleDescription() {
      const description = document.getElementById('description');
      const toggleBtn = document.getElementById('toggleBtn');
      
      if (description.classList.contains('collapsed')) {
        description.classList.remove('collapsed');
        description.classList.add('expanded');
        toggleBtn.textContent = 'عرض أقل';
      } else {
        description.classList.remove('expanded');
        description.classList.add('collapsed');
        toggleBtn.textContent = 'عرض المزيد';
      }
    }

    /**
     * Check if description needs toggle button
     */
    function checkDescriptionHeight() {
      const description = document.getElementById('description');
      const toggleBtn = document.getElementById('toggleBtn');
      const lineHeight = parseFloat(window.getComputedStyle(description).lineHeight);
      const maxHeight = lineHeight * 3; // 3 lines
      
      // Temporarily expand to check full height
      description.classList.remove('collapsed');
      const fullHeight = description.scrollHeight;
      description.classList.add('collapsed');
      
      // Hide toggle button if text is 3 lines or less
      if (fullHeight <= maxHeight + 5) { // +5 for tolerance
        toggleBtn.style.display = 'none';
      } else {
        toggleBtn.style.display = 'block';
      }
    }

    /**
     * Load available screenshots
     */
    function loadScreenshots() {
      const container = document.getElementById('screenshots-container');
      const extensions = ['png', 'jpg', 'jpeg'];
      const loadPromises = [];

      // Try to load screenshots from 1 to 10
      for (let i = 1; i <= totalToCheck; i++) {
        const promise = new Promise((resolve) => {
          tryLoadImage(i, extensions, 0, resolve, container);
        });
        loadPromises.push(promise);
      }
    }

    /**
     * Try to load image with different extensions
     */
    function tryLoadImage(number, extensions, extIndex, resolve, container) {
      if (extIndex >= extensions.length) {
        resolve(null);
        return;
      }

      const img = new Image();
      const filename = `screenshot${number}.${extensions[extIndex]}`;
      
      img.onload = function() {
        const currentIndex = screenshots.length;
        screenshots.push(filename);
        
        const imgElement = document.createElement('img');
        imgElement.src = filename;
        imgElement.dataset.index = currentIndex;
        imgElement.className = 'screenshot rounded-lg shadow-md cursor-pointer flex-shrink-0';
        imgElement.style.scrollSnapAlign = 'start';
        imgElement.alt = `لقطة شاشة ${number}`;
        imgElement.onclick = function() {
          openLightbox(parseInt(this.dataset.index));
        };
        
        container.appendChild(imgElement);
        resolve(filename);
      };
      
      img.onerror = function() {
        // Try next extension
        tryLoadImage(number, extensions, extIndex + 1, resolve, container);
      };
      
      img.src = filename;
    }

    /**
     * Open lightbox with specific image
     * @param {number} index - Image index to display
     */
    function openLightbox(index) {
      currentImageIndex = index;
      const lightbox = document.getElementById("lightbox");
      const lightboxImg = document.getElementById("lightbox-img");
      
      lightboxImg.src = screenshots[currentImageIndex];
      lightbox.classList.remove("hidden");
      lightbox.style.display = "block";
    }

    /**
     * Close lightbox
     */
    function closeLightbox() {
      const lightbox = document.getElementById("lightbox");
      lightbox.classList.add("hidden");
      lightbox.style.display = "none";
    }

    /**
     * Navigate between images
     * @param {number} direction - Direction to navigate (-1 for previous, 1 for next)
     */
    function navigateImage(direction) {
      currentImageIndex += direction;
      
      // Stop at boundaries
      if (currentImageIndex < 0) {
        currentImageIndex = 0;
        return;
      }
      
      if (currentImageIndex >= screenshots.length) {
        currentImageIndex = screenshots.length - 1;
        return;
      }
      
      document.getElementById("lightbox-img").src = screenshots[currentImageIndex];
    }

    /**
     * Keyboard navigation
     */
    document.addEventListener('keydown', function(event) {
      const lightbox = document.getElementById("lightbox");
      
      if (!lightbox.classList.contains("hidden")) {
        switch(event.key) {
          case "ArrowLeft":
            navigateImage(1); // Next (RTL)
            break;
          case "ArrowRight":
            navigateImage(-1); // Previous (RTL)
            break;
          case "Escape":
            closeLightbox();
            break;
        }
      }
    });

    // Load screenshots when page loads
    window.addEventListener('DOMContentLoaded', function() {
      loadScreenshots();
      checkDescriptionHeight();
    });

    // Recheck on window resize
    window.addEventListener('resize', checkDescriptionHeight);
  </script>

</body>
</html>
